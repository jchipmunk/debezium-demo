# debezium-demo


## Events

```sql
CREATE TABLE c##dbzuser.events (
  event_id NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY (START with 1 INCREMENT by 1) NOT NULL PRIMARY KEY,
  payload VARCHAR2(1000)
);
```

```sql
INSERT INTO c##dbzuser.events(payload) VALUES ('test');
```

```bash
curl -X POST -H "Accept:application/json" -H "Content-Type:application/json" http://localhost:8083/connectors -d '
{
  "name": "source-events-connector",
  "config": {
    "connector.class": "io.debezium.connector.oracle.OracleConnector",
    "tasks.max": "1",
    "database.hostname": "oracle",
    "database.port": "1521",
    "database.user": "c##dbzuser",
    "database.password": "dbz",
    "database.dbname": "orclcdb",
    "database.pdb.name": "orclpdb1",
    "database.connection.adapter": "logminer",
    "topic.prefix": "dbz",
    "schema.name.adjustment.mode": "avro",
    "table.include.list": "C##DBZUSER.EVENTS",
    "include.schema.changes": "false",
    "schema.history.internal.kafka.bootstrap.servers" : "kafka:9092",
    "schema.history.internal.kafka.topic": "schema-changes.events",
    "heartbeat.interval.ms": "60000",
    "log.mining.strategy": "online_catalog",
    "log.mining.query.filter.mode": "in",
    "custom.metric.tags": "connector=source-events-connector",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "false",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "false"
  }
}'
```

```bash
curl -X POST -H "Accept:application/json" -H "Content-Type:application/json" http://localhost:8083/connectors -d '
{
  "name": "sink-events-connector",
  "config": {
    "connector.class": "org.apache.kafka.connect.tools.MockSinkConnector",
    "topics": "dbz.C__DBZUSER.EVENTS",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "false",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "false"
  }
}'
```


## Data types

```sql
CREATE TABLE c##dbzuser.source_data_types (
  id                       NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY (START with 1 INCREMENT by 1) NOT NULL PRIMARY KEY,
  c_varchar2               VARCHAR2(400),
  c_nvarchar2              NVARCHAR2(400),
  c_number                 NUMBER(20),
  c_float                  FLOAT(63),
  c_decimal                DECIMAL(16),
  c_long                   LONG,
  c_binary_float           BINARY_FLOAT,
  c_binary_double          BINARY_DOUBLE,
  c_date                   DATE,
  c_timestamp              TIMESTAMP,
  c_timestamp_wtz          TIMESTAMP WITH TIME ZONE,
  c_timestamp_wltz         TIMESTAMP WITH LOCAL TIME ZONE,
  c_raw                    RAW(1000),
  c_char                   CHAR(100),
  c_nchar                  NCHAR(100),
  c_clob                   CLOB,
  c_nclob                  NCLOB,
  c_blob                   BLOB
);
```

```sql
CREATE TABLE c##dbzuser.debezium_sink_data_types (
  id                       NUMBER(10) NOT NULL PRIMARY KEY,
  c_varchar2               VARCHAR2(400),
  c_nvarchar2              NVARCHAR2(400),
  c_number                 NUMBER(20),
  c_float                  FLOAT(63),
  c_decimal                DECIMAL(16),
  c_long                   LONG,
  c_binary_float           BINARY_FLOAT,
  c_binary_double          BINARY_DOUBLE,
  c_date                   DATE,
  c_timestamp              TIMESTAMP,
  c_timestamp_wtz          TIMESTAMP WITH TIME ZONE,
  c_timestamp_wltz         TIMESTAMP WITH LOCAL TIME ZONE,
  c_raw                    RAW(1000),
  c_char                   CHAR(100),
  c_nchar                  NCHAR(100),
  c_clob                   CLOB,
  c_nclob                  NCLOB,
  c_blob                   BLOB
);
```

```sql
CREATE TABLE c##dbzuser.confluent_sink_data_types (
  id                       NUMBER(10) NOT NULL PRIMARY KEY,
  c_varchar2               VARCHAR2(400),
  c_nvarchar2              NVARCHAR2(400),
  c_number                 NUMBER(20),
  c_float                  FLOAT(63),
  c_decimal                DECIMAL(16),
  c_long                   LONG,
  c_binary_float           BINARY_FLOAT,
  c_binary_double          BINARY_DOUBLE,
  c_date                   DATE,
  c_timestamp              TIMESTAMP,
  c_timestamp_wtz          TIMESTAMP WITH TIME ZONE,
  c_timestamp_wltz         TIMESTAMP WITH LOCAL TIME ZONE,
  c_raw                    RAW(1000),
  c_char                   CHAR(100),
  c_nchar                  NCHAR(100),
  c_clob                   CLOB,
  c_nclob                  NCLOB,
  c_blob                   BLOB
);
```

```sql
CREATE TABLE c##dbzuser.aiven_sink_data_types (
  id                       NUMBER(10) NOT NULL PRIMARY KEY,
  c_varchar2               VARCHAR2(400),
  c_nvarchar2              NVARCHAR2(400),
  c_number                 NUMBER(20),
  c_float                  FLOAT(63),
  c_decimal                DECIMAL(16),
  c_long                   LONG,
  c_binary_float           BINARY_FLOAT,
  c_binary_double          BINARY_DOUBLE,
  c_date                   DATE,
  c_timestamp              TIMESTAMP,
  c_timestamp_wtz          TIMESTAMP WITH TIME ZONE,
  c_timestamp_wltz         TIMESTAMP WITH LOCAL TIME ZONE,
  c_raw                    RAW(1000),
  c_char                   CHAR(100),
  c_nchar                  NCHAR(100),
  c_clob                   CLOB,
  c_nclob                  NCLOB,
  c_blob                   BLOB
);
```

```sql
INSERT INTO c##dbzuser.source_data_types (
  c_varchar2,
  c_nvarchar2,
  c_number,
  c_float,
  c_decimal,
  c_long,
  c_binary_float,
  c_binary_double,
  c_date,
  c_timestamp,
  c_timestamp_wtz,
  c_timestamp_wltz,
  c_raw,
  c_char,
  c_nchar,
  c_clob,
  c_nclob,
  c_blob
)
VALUES (
  'varchar2',
  'nvarchar2',
  1,
  12.12,
  123.123,
  1234,
  1.234567E+003,
  1.234567E+003,
  TO_DATE('2019-01-30 18:30:52', 'YYYY-MM-DD HH24:MI:SS'),
  TO_TIMESTAMP('2019-01-30 18:30:52.123000','YYYY-MM-DD HH24:MI:SS.FF'),
  TO_TIMESTAMP_TZ('2019-01-30 18:30:52.123000 -08:00','YYYY-MM-DD HH24:MI:SS.FF TZH:TZM'),
  TO_TIMESTAMP('2019-01-30 18:30:52.123000','YYYY-MM-DD HH24:MI:SS.FF'),
  HEXTORAW('7D'),
  'char',
  'nchar',
  TO_CLOB('clob'),
  TO_NCLOB('nclob'),
  TO_BLOB(HEXTORAW('7D'))
);
```

```bash
curl -X POST -H "Accept:application/json" -H "Content-Type:application/json" http://localhost:8083/connectors -d '
{
  "name": "source-data-types-connector",
  "config": {
    "connector.class": "io.debezium.connector.oracle.OracleConnector",
    "tasks.max": "1",
    "database.hostname": "oracle",
    "database.port": "1521",
    "database.user": "c##dbzuser",
    "database.password": "dbz",
    "database.dbname": "orclcdb",
    "database.pdb.name": "orclpdb1",
    "database.connection.adapter": "logminer",
    "topic.prefix": "dbz",
    "lob.enabled": "true",
    "schema.name.adjustment.mode": "avro",
    "table.include.list": "C##DBZUSER.SOURCE_DATA_TYPES",
    "include.schema.changes": "false",
    "schema.history.internal.kafka.bootstrap.servers" : "kafka:9092",
    "schema.history.internal.kafka.topic": "schema-changes.data-types",
    "heartbeat.interval.ms": "60000",
    "log.mining.strategy": "online_catalog",
    "log.mining.query.filter.mode": "in",
    "custom.metric.tags": "connector=source-data-types-connector",
    "transforms": "unwrap",
    "transforms.unwrap.type": "io.debezium.transforms.ExtractNewRecordState",
    "transforms.unwrap.delete.handling.mode": "none",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "true",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "true"
  }
}'
```

"decimal.handling.mode": "string",
"time.precision.mode": "connect",

```bash
curl -X POST -H "Accept:application/json" -H "Content-Type:application/json" http://localhost:8083/connectors -d '
{
  "name": "debezium-sink-data-types-connector",
  "config": {
    "connector.class": "io.debezium.connector.jdbc.JdbcSinkConnector",
    "tasks.max": "1",
    "connection.url": "jdbc:oracle:thin:@oracle:1521/orclpdb1",
    "connection.username": "c##dbzuser",
    "connection.password": "dbz",
    "topics": "dbz.C__DBZUSER.SOURCE_DATA_TYPES",
    "insert.mode": "upsert",
    "delete.enabled": "true",
    "primary.key.mode": "record_key",
    "table.name.format": "c##dbzuser.DEBEZIUM_SINK_DATA_TYPES",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "true",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "true"
  }
}'
```

```bash
curl -X POST -H "Accept:application/json" -H "Content-Type:application/json" http://localhost:8083/connectors -d '
{
  "name": "confluent-sink-data-types-connector",
  "config": {
    "connector.class": "io.confluent.connect.jdbc.JdbcSinkConnector",
    "tasks.max": "1",
    "connection.url": "jdbc:oracle:thin:@oracle:1521/orclpdb1",
    "connection.user": "c##dbzuser",
    "connection.password": "dbz",
    "topics": "dbz.C__DBZUSER.SOURCE_DATA_TYPES",
    "insert.mode": "upsert",
    "pk.mode": "record_key",
    "pk.fields": "ID",
    "transforms": "unwrap,tsConvert,route",
    "transforms.unwrap.type": "io.debezium.transforms.ExtractNewRecordState",
    "transforms.unwrap.drop.tombstones": "false",
    "transforms.tsConvert.type": "org.apache.kafka.connect.transforms.TimestampConverter$Value",
    "transforms.tsConvert.format": "yyyy-MM-dd HH:mm:ss.SS",
    "transforms.tsConvert.target.type": "string",
    "transforms.tsConvert.field": "C_TIMESTAMP",
    "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
    "transforms.route.regex": "dbz\\.C__DBZUSER\\.SOURCE_DATA_TYPES",
    "transforms.route.replacement": "CONFLUENT_SINK_DATA_TYPES",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "true",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "true"
  }
}'
```

```bash
curl -X POST -H "Accept:application/json" -H "Content-Type:application/json" http://localhost:8083/connectors -d '
{
  "name": "aiven-sink-data-types-connector",
  "config": {
    "connector.class": "io.aiven.connect.jdbc.JdbcSinkConnector",
    "tasks.max": "1",
    "connection.url": "jdbc:oracle:thin:@oracle:1521/orclpdb1",
    "connection.user": "c##dbzuser",
    "connection.password": "dbz",
    "topics": "dbz.C__DBZUSER.SOURCE_DATA_TYPES",
    "insert.mode": "upsert",
    "pk.mode": "record_key",
    "pk.fields": "ID",
    "transforms": "unwrap,route",
    "transforms.unwrap.type": "io.debezium.transforms.ExtractNewRecordState",
    "transforms.unwrap.drop.tombstones": "false",
    "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
    "transforms.route.regex": "dbz\\.C__DBZUSER\\.SOURCE_DATA_TYPES",
    "transforms.route.replacement": "AIVEN_SINK_DATA_TYPES",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "true",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "true"
  }
}'
```


